"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateToken = exports.generateToken = void 0;
const uuid_1 = require("uuid");
const activeTokens = [];
const maxTokens = 1024;
let tokenIndex = 0;
function newToken() {
    const token = uuid_1.v4().replace(/\-/g, '');
    activeTokens[tokenIndex++] = token;
    if (tokenIndex === maxTokens) {
        tokenIndex = 0;
    }
    return token;
}
function generateToken(options, { password, username }) {
    const accounts = options.accounts || [];
    const user = username.toUpperCase();
    for (const account of accounts) {
        if (account.username.toUpperCase() === user && account.password === password) {
            return newToken();
        }
    }
    return undefined;
}
exports.generateToken = generateToken;
function validateToken(_options, token) {
    return activeTokens.indexOf(token) !== -1;
}
exports.validateToken = validateToken;
