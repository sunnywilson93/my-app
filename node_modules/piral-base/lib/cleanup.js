"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cleanup = void 0;
const utils_1 = require("./utils");
function cleanup(pilet) {
    const css = document.querySelector(`link[data-origin=${JSON.stringify(pilet.name)}]`);
    css === null || css === void 0 ? void 0 : css.remove();
    // check if this was actually set up using a require reference
    if ('requireRef' in pilet) {
        const depName = pilet.requireRef;
        delete window[depName];
    }
    // remove the pilet's evaluated modules from SystemJS (except the shared dependencies)
    if ('link' in pilet) {
        const basePath = (0, utils_1.getBasePath)(pilet.link);
        const dependencies = Object.keys(pilet.dependencies || {}).map((m) => pilet.dependencies[m]);
        [...System.entries()]
            .filter(([id]) => id.startsWith(basePath) && !dependencies.includes(id))
            .forEach(([id]) => System.delete(id));
    }
}
exports.cleanup = cleanup;
//# sourceMappingURL=cleanup.js.map