"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadLegacyPilet = void 0;
const load_1 = require("./load");
const fetch_1 = require("./fetch");
const utils_1 = require("./utils");
const dependency_1 = require("./dependency");
/**
 * Loads a legacy (v0) or invalid pilet.
 * @param meta The metadata of the pilet.
 * @returns The evaluated pilet that can now be integrated.
 */
function loadLegacyPilet(meta) {
    const name = meta.name;
    if ('link' in meta && meta.link) {
        const link = (0, utils_1.setBasePath)(meta, meta.link);
        return (0, fetch_1.fetchDependency)(link).then((content) => (0, load_1.loadFrom)(meta, () => (0, dependency_1.compileDependency)(name, content, link)));
    }
    else if ('content' in meta && meta.content) {
        const content = meta.content;
        return (0, load_1.loadFrom)(meta, () => (0, dependency_1.compileDependency)(name, content, undefined));
    }
    else {
        console.warn('Empty pilet found!', name);
    }
    return Promise.resolve((0, utils_1.createEmptyModule)(meta));
}
exports.loadLegacyPilet = loadLegacyPilet;
//# sourceMappingURL=legacy.js.map