"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Modals = void 0;
const React = require("react");
const piral_core_1 = require("piral-core");
const components_1 = require("./components");
function closeAll(modals) {
    modals.forEach((m) => m.close());
}
function findModal(modals, name) {
    if (name) {
        const [modal] = Object.keys(modals)
            .filter((m) => modals[m].name === name)
            .map((m) => modals[m]);
        return modal;
    }
    return undefined;
}
const Modals = () => {
    const modals = (0, piral_core_1.useGlobalState)((s) => s.registry.modals);
    const dialogs = (0, piral_core_1.useGlobalState)((s) => s.modals);
    const close = () => closeAll(dialogs);
    const children = dialogs
        .map((n) => {
        const reg = modals[n.name] || findModal(modals, n.alternative);
        const Component = reg && reg.component;
        const defaults = reg && reg.defaults;
        const options = Object.assign(Object.assign({}, defaults), n.options);
        return (Component && (React.createElement(components_1.PiralModalsDialog, Object.assign({}, n, { options: options, defaults: reg.defaults, layout: reg.layout, key: n.name }),
            React.createElement(Component, { onClose: n.close, options: options }))));
    })
        .filter(Boolean);
    const open = children.length > 0;
    return (React.createElement(components_1.PiralModalsHost, { open: open, close: close }, children));
};
exports.Modals = Modals;
exports.Modals.displayName = 'Modals';
//# sourceMappingURL=Modals.js.map