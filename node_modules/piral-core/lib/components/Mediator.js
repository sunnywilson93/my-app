"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Mediator = void 0;
const React = require("react");
const piral_base_1 = require("piral-base");
const hooks_1 = require("../hooks");
const utils_1 = require("../utils");
/**
 * The Mediator component for interfacing with pilets loading.
 */
const Mediator = ({ options }) => {
    const { initialize, readState } = (0, hooks_1.useGlobalStateContext)();
    React.useEffect(() => {
        const shouldLoad = readState(s => s.app.loading);
        if (shouldLoad) {
            const { connect, disconnect } = (0, piral_base_1.startLoadingPilets)(options);
            const notifier = (error, pilets, loaded) => {
                initialize(!loaded, error, pilets);
            };
            connect(notifier);
            return () => disconnect(notifier);
        }
    }, utils_1.none);
    // tslint:disable-next-line:no-null-keyword
    return null;
};
exports.Mediator = Mediator;
//# sourceMappingURL=Mediator.js.map