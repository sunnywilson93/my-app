"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultApiFactory = exports.createExtenders = void 0;
const piral_base_1 = require("piral-base");
const core_1 = require("./core");
function createExtenders(context, apis) {
    const creators = [core_1.createCoreApi, ...apis.filter(piral_base_1.isfunc)];
    return creators.map((c) => {
        const ctx = c(context);
        if ((0, piral_base_1.isfunc)(ctx)) {
            return ctx;
        }
        else {
            return () => (Object.assign({}, ctx));
        }
    });
}
exports.createExtenders = createExtenders;
function defaultApiFactory(context, apis) {
    const extenders = createExtenders(context, apis);
    return (target) => {
        const api = (0, piral_base_1.initializeApi)(target, context);
        context.apis[target.name] = api;
        return (0, piral_base_1.mergeApis)(api, extenders, target);
    };
}
exports.defaultApiFactory = defaultApiFactory;
//# sourceMappingURL=api.js.map